<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Subscription Analytics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>Subscription Analytics</h1>
    <p>Active Customers: {{ active_customers }}</p>
    <p>Total Monthly Spend: ${{ total_spend }}</p>
    <p>Churn Rate: {{ churn_rate }}%</p>
    <!-- Filter by Date Range -->
<form method="POST" action="/filter">
    Start Date: <input type="date" name="start_date" required>
    End Date: <input type="date" name="end_date" required>
    <input type="submit" value="Filter">
</form>
<div>
    <a href="/metrics" style="padding: 10px 15px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">View Metrics Dashboard</a>
</div>
<!-- Filter by Active Status -->
<form method="POST" action="/filter_status">
    <select name="status_filter">
        <option value="all">All</option>
        <option value="active">Active</option>
        <option value="churned">Churned</option>
    </select>
    <input type="submit" value="Filter">
</form>

    <table>
        <tr>
            <th>Name</th>
            <th>Subscription Start</th>
            <th>Subscription End</th>
            <th>Monthly Spend</th>
            <th>Active Status</th>
            <th>Actions</th>
        </tr>
        {% for customer in customers %}
        <tr>
            <td>{{ customer.name }}</td>
            <td>{{ customer.subscription_start }}</td>
            <td>{{ customer.subscription_end }}</td>
            <td>${{ customer.monthly_spend }}</td>
            <td>{{ 'Active' if customer.is_active else 'Churned' }}</td>
            <td>
                <a href="/edit/{{ customer.id }}">Edit</a>
                <a href="/delete/{{ customer.id }}">Delete</a>
            </td>
        </tr>
        {% endfor %}
    </table>
    <a href="/add">Add New Customer</a>
    <a href="/charts">View Charts</a>
</body>
</html>
